<workflow>
	<rule match="$.services[*].units[?(not @.state.osImageName)]" desc="Units with no image">
        <set path="#osImageMap">
            <map>

 <!--  ====================================================================== -->
 <!--  Mappings between image IDs and image file names can be configured here -->
 <!--  ====================================================================== -->

            <mapping name="ws-2012-std">ws-2012-std</mapping>
            <mapping name="ws-2012-core">ws-2012-core</mapping>
            <mapping name="ws-2008r2-std">ws-2008r2-std</mapping>
            <mapping name="ws-2008r2-core">ws-2008r2-core</mapping>

            <!-- image to use if no image id provided -->
            <mapping name="DEFAULT">ws-2012-full</mapping>

 <!--  ====================================================================== -->

            </map>
        </set>
		<set path="state.osImageName">
			<select source="osImageMap">
                <parameter name="path"><select path="::osImage" default="DEFAULT"/></parameter>
			</select>
		</set>
    </rule>

 </workflow>